基于机器学习的钓鱼网站数据集分析方法与实现			


第一章绪论

1.1概述

	随着科技的进步与发展，人们的生活越来越离不开网络，社交应用，电商购物，游戏娱乐，虚拟货币等等相关应用与人们的个人隐私息息相关。而现如今，越来越多的人使用支付宝，微信，虚拟货币等等来消费购物，很多人的网络帐号里都有大量的资金或者等价值的虚拟物品，于是，很多不法分子便将目光投向了网络用户的网络帐号中的资金和物品。而网络钓鱼相较于其他黑客手段，则是门槛较低，操作较为简单的一种盗取用户帐号密码的攻击方式。
	“网络钓鱼”，英文名为“Phishing”，由于现如今杀毒软件的流行和漏洞的快速修复，并且通过撞库，入侵等手段获取用户的帐号密码需要大量的时间和尝试，并且对黑客技术要求较高，所以很多网络上的攻击者便通过模仿的email和网站来伪装成正规的网站和邮件，来让访问者误以为他们进入的是正规的网站，进而输入自己的相关帐号密码等一些敏感信息，然而这些敏感信息最后都会落入攻击者之手，轻者丢失一些资金，严重的可能连帐号密码都会被攻击者修改。
	在网络高度发达的今天，网络钓鱼攻击已经成为了一个很大的隐患，由于它与其他的网络攻击行为（病毒，蠕虫，漏洞）并不太一样，它是一种社会工程学的网络攻击行为，并且主要面向那些对互联网不太熟悉或者比较粗心的用户，利用他们并不会仔细检查网站和邮件不同的心理，来达到欺骗他们来获取用户帐号密码的罪恶目的。

1.2研究的背景和意义

	现如今的网络钓鱼形势与前两年相比有了很大的不同，主要体现在两个方面。
	其一，钓鱼攻击者的攻击目标与以前相比有了很大的不同，主要是因为现如今很多用户喜欢将自己不同网站的密码设置成一样，根据2017电商生态安全联盟发布的《电子商务生态安全白皮书》[1]，不法分子前期的盗号主要通过钓鱼木马来进行，后期则是由于不法分子手上掌握了大量的已泄露的网站数据库，而很多用户使用不同帐号时设置的密码完全一样，据统计，黑色产业人员掌握了数十亿对帐号密码关系，而通过撞库和刷库盗取的帐号占所有被盗帐号的80%。不仅如此，现在大部分网站的用户身份认证方式已经从唯一的用户名密码演变成了”手机号+密码“或”邮箱+密码“，这致使用户的某一网站的帐号密码泄露后，其他的没有设置短信身份验证的网站的帐号密码就会全部泄露。
	其二，近两年，随着勒索病毒攻击事件的大量出现，部分感染用户并没有备份重要文件的习惯从而不得不支付赎金，以恢复自己被加密的文件，这也导致黑客们尝到了勒索病毒攻击的甜头。而传播勒索病毒的很高效的方法就是大范围的网络钓鱼攻击。
	最近的趋势表明，网络钓鱼攻击者的目标从根本上改变了，现在不法分子选择目标主要基于一下三点：一， 获得帐号密码，然后立刻偷取账户中的钱;二，不法分子可以里同这些帐号密码在更大范围内发动撞库攻击;三，不法分子收集被钓鱼者的信息，然后将这些信息利用到其它违法活动中，比如：身份盗窃，出卖信息。[2]
	根据国家互联网应急中心（以下简称CNCERT）发布的《2017年我国互联网网络安全态势综述》[3]，2017年，CNCERT检测发现了4.9万个仿冒我国网站的网页，相比与2016年的17.8万个，有了明显的下降，从顶级域名分布情况来看，如图一所示，“com”，“c”，“cn”占比为前三位;从仿冒类型来看，实名认证和积分兑换仿冒页面占比最多;从仿冒网站的IP地址归属来看，如图二所示，有88%位于境外，而其中我国香港的钓鱼网站IP地址占了境外钓鱼网站总数的一半 
		图一，2017年钓鱼网站所用顶级域名分布
		图二，2017年钓鱼网站IP地址归属分布
	最早的网络钓鱼攻击出现在美国部分地区，然而随着我国互联网产业的高速发展，尤其是网络支付和电商购物，越来越多的网络钓鱼攻击如雨后春笋般纷纷出现在神舟大地上。而对于普通用户，尤其是中老年用户来说，他们只能从外观上来判别这个网站是不是自己想登录的网站，而几乎所有钓鱼网站在外观上与正规网站都高度相似，所以他们很难分辨清楚自己登录的是不是钓鱼网站，再加上他们的防范意识较差，一旦他们登录了钓鱼网站，十有八九就会输入自己的敏感信息和帐号密码，从而遭受到经济损失。现如今网络钓鱼攻击已经遍布互联网的方方面面，对用户私人信息，网络支付和电商购物造成了相当大的危害，严重影响了部分人群对互联网安全的信心。

1.3研究目标

	虽然钓鱼网站的手段多种多样，但是万变不离其宗，我们依然可以从最根本的方面来检测钓鱼网站，这就为我们检测钓鱼网站提供了理论基础。传统的依靠人力检测与举报的方法在钓鱼网站数量较少的时候还是可行的，然而现如今这信息爆炸的时代，它是万万不可行的。
	现如今，机器学习已经经历了几十年的发展，有高潮也有低谷，以深度学习为代表的机器学习是目前较为接近人类大脑的人工智能方法，虽然目前机器学习仍然处于起步阶段，与人脑相比依然存在巨大的差距，然而在海量相似数据的分析处理这一方面，机器学习具有消耗速度较快，消耗人力较少，准确度较高的优势。
	因此我希望通过对这个课题的研究，通过对大量钓鱼网站数据集的分析，准确地提取出它们的特征，并采用机器学习的方法来分析这些特征以达到识别钓鱼网站的目的。

1.4本文架构

	本文一共分为六个章节
	第一章是绪论首先介绍了当前网络钓鱼的形势，然后讲述了研究的背景和意义以及目标。
	第二章是国内外研究现状的介绍，首先介绍了网络钓鱼攻击的流程，然后阐述了现阶段常见的网络钓鱼攻击技术，最后介绍了当前流行的常见的网络钓鱼检测技术。
	第三章主要介绍了基于机器学习的钓鱼网站数据集分析方法的流程，首先对比了常见钓鱼网站检测技术的优劣，然后从算法流程这个方面，依次介绍了数据预处理，特征提取，分类器训练与处理。
	第四章对比研究并实现了常见的分类器模型，分别研究并实现了K-近邻算法，决策树，Logistic回归，Adaboost 与 随机森林，然后比较了这些分类器的分类准确率。
	第五章在前一章的基础上改进了随机森林算法，然后将它与改进之前的算法进行对比。
	第六章在前五章的基础上总结了本文的研究内容，探讨了可能的算法改进之处并展望未来。

第二章国内外研究现状

2.1引言

	网络钓鱼攻击是一种利用社会工程技术来企图伪装成用户熟悉的网站以获得帐号密码和信用卡相关信息的犯罪行为，由于现代社会的信息爆炸，对于很多用户来说，如何分辨网站是否仿冒并不是一件很简单的事情。从网络钓鱼的攻击目标来看，网络钓鱼攻击可以分为两类，一类是针对银行和在线支付的用户，不法分子通过高度仿冒的网站界面来诱使用户输入相关信息以达到不可告人的秘密;另一类是针对社交网站用户，因为不法分子可以将从社交网站用户那里非法获取的数据用于身份盗窃，伪装成用户，向他的朋友亲戚发送钓鱼邮件。常言道：知己知彼，百战不殆。所以接下来，我将先介绍常见的网络钓鱼攻击技术。

2.2网络钓鱼攻击技术

	根据各自的特点，研究人员将常见的网络钓鱼攻击技术分为以下以下六类：伪装真实网站的链接，规避内容过滤器的检测，伪造正规网站，通过电话进行网络钓鱼，通过wifi免费热点来进行网络钓鱼，利用网站漏洞来进行网络钓鱼。接下来我将介绍这六类网络钓鱼攻击技术。

2.2.1伪装真实网站网址
	
	首先我必须要介绍一下目前的浏览器是如何识别url的，现在使用的浏览器不仅支持采用ASCII编码的网址，还能兼容那些对那些字符采用url编码处理的网址，而所谓的url编码的实际上就是把相应的网址转为ASCII编码形式，最后再加上分割符号“%”并且把他们转为十六进制字符。举个例子，www.amazon.cn和www.amazon%2E%63%6E实际上指向的都是亚马逊中国的主页。
	因此大部分的网络钓鱼攻击技术都是利用人们对网络内容并无太多防备之心来完成某种意义上的视觉欺骗，常见做法是通过邮箱或者短信给你发送一封邮件或者短信，里面含有似乎属于真正合法组织的网址，然而实际上，不法分子故意注册一个与正规网站域名高度相似的域名，例如www.amazan.cn或者www.amazon.example.cn再将其中的”.example”转为url编码形式，然后网页的内容与亚马逊中国高度相似甚至完全一样，如图三所示，这样对于普通的互联网用户来说，他们看到amazon可能就会认为这是正规网站而不会细思，也就不会联想到这个链接实际上指向的是一个钓鱼网站，从而致使普通用户被欺骗，遭受经济损失。另一种常见的手段是使用锚文本链接，例如接下来的锚文本名为：您的中国银行账户主页，实际上它指向的是另外的虚假的网页[4]
		图三，高度相似的亚马逊中国钓鱼网站

2.2.2规避内容过滤器的检测
	
	首先让我来介绍一下 什么是内容过滤器，由于很多钓鱼网站都包含“帐号”，“密码”等等这样的敏感词，如果浏览器检测到用户正在访问的网站并不是官方网站，或者有钓鱼网站的嫌疑，如果此时该网站中包含“帐号”，“密码”这样的敏感词，浏览器就会提示用户，让其注意一下目前访问的是不是正版网站，并且小心输入帐号密码。
	在越来越多的网站采用内容过滤器后，不法分子开始将目光转到了图片上，通过采用包含“支付宝”，“银行”，“帐号”，“密码”等等这样的关键字图片，来避免被浏览器的内容过滤器识别，如图四，图五所示。
我们可以看到，图四中是一个与PayPal网站高度相似的钓鱼网站，然而如果我们选中高亮的红色提示文字，我们就会发现其中的”PayPal account”其实是图片，这样浏览器的内容过滤器就不会识别并向用户发出警告了。[5]
	
	图四，高度相似的PayPal网站
	图五，关键词被图片所代替

2.2.3伪造正规网站

	某些时候就算用户认真检查了网址，可能也无法发现端倪。例如：一些网络钓鱼攻击者通过使用JavaScript命令，可以使得浏览器的地址栏被一张合法网址的地址栏图片盖住，或者是重新访问一个新的网页。如图六所示，该网页的地址栏实际上被工具栏图片所掩盖，这时候不法分子就可以将它们想伪装的网址放到工具栏图片中，只有当用户右键单击工具栏后，才会发现真正的地址栏，如图七所示。[6]现在，很多不法分子采用flash或者h5技术来构建网页，将自己的文字隐藏在多媒体对象等一些浏览器难以检查的对象中，以逃避反网钓技术的扫描。
	
	图六，地址栏被图片掩盖的网页

	图七，当右键单击工具栏之后，弹出地址栏

2.2.4电话网钓

	网络钓鱼不仅仅出现在网络中，现在有很多不法分子利用伪基站或一些奇淫技巧伪装成某些节目或者运营商的官方号码，然后大批量向该区域内的用户发送中奖短信，然而短信中一般包含的都是钓鱼网站的网址，一旦用户轻信了这些网站，一不小心点开链接并输入自己的敏感信息，就会遭受巨大的经济损失

2.2.5利用免费wifi热点

	随着科技的发展，网速已经越来越快，由于流量是有限的并且还是比较昂贵的，所以越来越多的用户离不开公共场所的免费wifi热点，然而有部分黑客，会在公共场所设置一个假的wifi热点，来吸引用户连接该热点。一旦用户不小心登录了黑客设置的伪wifi热点，那么轻则丢失自己个人数据和隐私文件，更严重者的手机电脑会被黑客安装间谍软件，设置后门。很多城市都有免费的公共wifi，比如武汉有些地方的免费公共wifi名为iWuhan-free，这时候，黑客就可以设置一个假的wifi热点，名字叫WuhanGongGong-free，而对那一带不熟悉的人并不知道wifi的真假，这样就会掉入黑客的陷阱

2.2.6利用网站漏洞

	近几年比较知名的漏洞就是，新加坡南洋理工大学一名博士生于2014年5月发现了OAuth和OpenID开源登录工具的“隐蔽重定向漏洞”（英文名为：Covert Redirect）[7][8]。攻击者利用该漏洞可以创建一个使用真实网站地址的弹出登录窗口，从而取代了之前的使用相似域名和界面的低级手段，从而引诱用户输入他们的个人信息，由于别的网络钓鱼方法基本上用的都是假的网站，而该漏洞利用了真的知名网站来进行钓鱼，以假乱真，让人难以分辨。只要访客访问该钓鱼网站并且登录授权，黑客就可以立刻读取该用户存储在该网站上的私密数据。
	相比与其他的网络钓鱼攻击技术，利用网站漏洞的黑客网钓行为破坏力是最大的，也是普通用户很难防备的。用户能做的只有积极更新浏览器或者使用安全软件下载补丁并修复漏洞。

2.3网络钓鱼网站检测技术
	
	虽然黑客们网络钓鱼的手段层出不穷，但是万变不离其宗，只要抓住它的核心，就不难检测出这些钓鱼网站。现如今，国内国外的机构组织也都认识到了钓鱼网站的危害，早早就成立了一些专门的组织，用以检测并封禁钓鱼网站。
	在国内，比较知名的有中国反钓鱼网站联盟（简称：”APAC”)[9]，它是于2008年成立的国内首个专门为了解决此问题而成立的民间行业协调组织，APAC旨在建立反钓鱼网站协调机制，推动反钓鱼网站综合治理体系的建设，共享反钓鱼网站的有关信息，它的成员包括了银行证券，电子商务等网络钓鱼重灾区以及域名管理注册机构，力求从域名这一根本上遏制住钓鱼网站的势头。
	在国外，比较知名的有PhishTank[10]，它是一个基于社区的反钓鱼攻击的网站，2006年10月份成立，同时也是OpenDNS的子公司，它的网站用户可以从全世界各地向该网站提交汇报钓鱼网站网址，再经其他用户投票认证，若确定它是钓鱼网站，则通过该网站的API接口共享给所有使用PhishTank服务的企业和个人。
目前有很多知名安全公司和机构都在使用PhishTank的服务来过滤钓鱼网站。
	根据检测依据的不同，按照基于URL检测，基于启发式检测和基于视觉相似检测的顺序，网络钓鱼网站检测技术主要可以分为以下几种：URL黑名单检测，机器学习判别网址，结合多种特征检测钓鱼网站，根据网站拓扑结构检测钓鱼网站，根据视觉相似度检测钓鱼网站

2.3.1URL黑名单检测技术

	当某个用户或者组织机构发现钓鱼网站之后，经确认无误后，再将该钓鱼网站的网址上传到黑名单中，最后某些公司根据这个黑名单来拦截钓鱼网站，这就是URL黑名单检测技术，这是最传统也是最原始的方法，目前主流的浏览器和知名IT公司大都将该检测技术包含在了自己的钓鱼网站检测系统中。虽然该方法的检测精度简单易实现，并且准确度高，但是由于该方法太过于依赖人工验证，并且由于数据来源有限，经常会导致无法及时更新黑名单的问题，不仅如此，很多钓鱼网站的生存周期都非常短暂，因此每次更新黑名单都需要检测黑名单中的网址是否依然存活，若否则将其从黑名单移除，并且人工识别存在着费时费力，低效成本过高的问题，不难看出，该技术最大的问题就是无法实时更新黑名单除非消耗海量人力来进行黑名单更新工作，所以该技术并不足以完全承担起检测钓鱼网站的重任。

2.3.2机器学习判别

	
 	常见的基于机器学习的钓鱼网站检测技术是基于网站的URL的，通常流程为：获得网址数据集，数据集预处理，从数据集中提取出特征向量，训练分类器模型，使用分类器分类网址。接下来我将以Garera算法[11]为例，简要阐述一下该方法：首先研究人员分析常见的钓鱼网址的URL结构特点，然后利用Logistic Regression分类器对URL进行分类，最后将常见的钓鱼网站网址分为4种类型，再结合网页外观特点，域名网址特点，网址类型等提取出18个特征，最后采用回归滤波器来训练该分类器十八个特征的系数，最后采用测试数据，来测试算法的准确率

2.3.3结合多种特征综合判别

	由于不同的钓鱼网站采用的技术手段并不相同，只根据单一特征或单一方面来判断该网站是不是钓鱼网站，并不能得到太准确的结果，所以现在常见的手段是结合待检测网站的多个方面综合判断。例如CATINA系统，该系统是Zhang[12]等研究人员设计的基于网页内容等多个方面的钓鱼网站检测系统。该系统通过分析网页中每个术语的TF-IDF值，然后以前5个最大TF-IDF值的术语作为术语组，然后用谷歌搜索该术语组，如果该网址与前n个搜索结果的网址匹配，那么这个疑似钓鱼网站的网址就是合法的了。不仅如此，研究人员还通过采用域名生存周期，引用图片，可疑链接等特征，用以确定钓鱼网站。在没有结合这些特征之前，该算法的报错率高达30%，然而当我们采用这些特征后，该算法的准确率达到了95%。

2.3.4基于网站拓扑结构检测

	根据研究人员的分析，他们发现钓鱼网站一般只是在外观上高度与正规网站高度相似，然而钓鱼网站里面的空链接重复链接无效链接数量大大多于正规网站。因此，研究人员认为可以从网站的拓扑结构入手，对钓鱼网站和正规网站加以区分，因为通常情况下，正规网站的拓扑结构十分复杂，特别是银行金融和网络电商网站，由于数据量十分庞大，所以网站里面含有非常多的有效网页链接，然而模仿正规网站的钓鱼网站一般都只会复制外观，里面的这些链接多以空链接，无效链接的形式存在，所以钓鱼网站的拓扑结构与其模仿的网站相比都会十分简单。2008年，有研究人员Eric Medvet[13]提出了基于网站拓扑结构的钓鱼网站检测方法，取得了不错的效果。

2.3.5根据视觉相似度检测	

	由于钓鱼网站本质上，与被模仿的网页外观几乎一样，所以有研究人员抓住这点，以此视觉相似度作为判断依据，用以检测钓鱼网站。该方法的通用流程是：把待检测网页转换成图片，然后将图片处理为向量形式，最后根据该向量，与疑似被模仿网页的图片向量相比较，若相似度超过阈值，则判定为钓鱼网站。最开始提出根据视觉相似度来检测钓鱼网站的是邓小铁等研究人员，他们认为应该根据网页的关键区域，版式和整体外观来判断钓鱼网站与目标网站在外观上是否相似。但是由于不同的显示器分辨率不同，不同的电脑的默认字体也很有可能不同，再加上很多网页都是采用模板设计的，因此根据视觉相似度来检测钓鱼网站最大的缺点就是准确度不高，容易误判。

2.4本章小结

	本章依次介绍了常见的钓鱼攻击技术，钓鱼网站检测技术，我们要认识到，网络黑客与网络安全技术人员之间的战争是狂日持久的，虽然已经众多研究人员在不断地研究新的钓鱼网站检测技术，但是不法分子也在根据我们的检测和应对技术不断更新他们的网络钓鱼技术，我们决不能掉以轻心。
	由于现如今网络上的网站数量是天文数字级别的，而机器学习在处理海量相似数据集上，存在着需求人力相对较少，速度较快的优点的同时，还拥有不错的准确度，所以本文将采用机器学习的方法，对钓鱼网站数据集进行分析检测。接下的第三章，我将简要阐述该方法的基本流程和依据。

3基于机器学习的检测方法的准备工作

3.1算法流程简介

	所有的算法都离不开数据，所以我们算法的第一步是，特征提取：首先我们从网络上的开源数据库里获得相应的网页数据，由于直接的网页数据包含了网址，页面代码等等无法直接量化处理的数据，所以我们要根据之前制定好的规则，对这些网页内容进行特征提取，将一条条网页数据向量化，方便我们使用机器学习的方法对钓鱼网站进行检测。
	然后我们算法的第二步是数据预处理：由于经过特征提取之后获取的数据可能存在遗漏和缺失，所以接下来要做的是对遗漏和缺失数据进行处理，通常情况下，如果直接丢弃掉那些存在遗漏和缺失的数据，当然是最好的，并且不会造成太多误差，然而在数据集比较小或者缺失数据较多的情况下，这样做会导致损失大量有效数据，所以一般情况下我们会将缺失遗漏数据设为默认值或者是那些不影响分类结果的数值;
	之后我们算法的第三步是训练分类器，这里我主要采用监督学习类的分类算法，监督学习一般使用标称型和数值型的变量，例如：真假，01。只要机器采用了合适的模型，就能从我们输入的数据里预测出分类结果。如图八所示

	图八，算法流程图

3.2特征提取

	如果只从钓鱼网站的URL里面提取特征，那么肯定是不准确的，因为一个网站不仅仅有网址，还有外观等多个方面，所以本文中，我将从以下四个方面提取特征：基于URL提取特征，基于网页异常部分提取特征，基于HTML和JS代码提取特征，基于域名提取特征。

3.2.1基于URL提取特征

特征1.网址中是否包含IP地址
	
	如果一个网站的网址中包含有IP地址，例如：“http://125.97.3.122/example.html”，那么用户就可以确信有人尝试偷窃他们的个人信息，就几乎可以确定他们访问的网站是钓鱼网站。有时候IP地址甚至会被转换成十六进制格式，例如：“http://0x58.0xCC.0xCA.0x62/1/example.cn/index.html”。

转换规则
判断结果
对应变量值
如果网址中包含IP地址
钓鱼网站
1
如果网址中没有包含IP地址
合法网站
0

特征2.URL是否很长

	有些钓鱼者喜欢使用很长的URL以便他们将URL中可能引起用户怀疑的部分藏在其中，例如：”http://federmacedoadv.com.br/3f/aze/ab51e2e319e51502f416dbe46b773a5e/？cmd=_home&amp;dispatch=11004d58f5b74f8dc1e7c2e8dd4105e811004d58f5b74f8dc1e7c2e8dd4105e8@phishing.website.html“。为了保证研究的准确性，有研究人员计算了数据集中的URL长度，并且得到了平均URL长度值——54。所以综合来看，若URL长度小于54则可以判断该网址不是钓鱼网站，详细规则见下表：
转换规则
判断结果
对应变量值
URL长度小于54
合法网站
-1
URL长度小于等于75大于等于54
可疑网站
0
URL长度大于75
钓鱼网站
1

特征3.使用非常短的URL
	
	有些钓鱼者喜欢很短的URL，然后通过HTTP重定向来将该短域名链接到一个具有很长URL的网页上。例如：”http://portal.hud.ac.uk/“可以被缩短为”bit.ly/19DXSk4“，如果使用了非常短的URL，则判断为钓鱼网站;反之则为合法网站。

特征4.URL中含有”@“符号

	由于在URL中使用”@“符号会导致浏览器忽略”@“符号之前的所有内容，然后真正的地址往往被钓鱼者放到”@“符号之后。所以如果网址中含有”@“符号，则为钓鱼网站;反之则否。

特征5.使用”//“重定向
	
	如果一个URL中存在着”//“，那么意味着用户将被重定向到另一个网站，例如：”http://www.legitimate.com//http://www.phishing.com“，我们检查一下有”//“出现的例子，不难发现，如果网址以”http”开头，那么“//”应该出现在第六位而不应该出现在其他位置;如果网址以“https”开头，那么“//”应该出现在第七位。所以如果网址之中最后出现“//”的位置在第七位以后，则为钓鱼网站。

特征6.域名中含有“-”

	由于破折号在合法的网址中很少被使用，所以钓鱼者倾向于在域名的前后添加“-”，这样会误导用户认为他们正在访问合法网页。所以如果网址中包含有“-”符号，我们认为其为钓鱼网站。

特征7.含有多级子域名

	让我来举个例子，首先假设我们现在遇到了这个链接“http://www.hud.ac.uk/students/”，首先一个网址中可能包含国家代码，顶级域名，例如本网址中的“uk”，而“ac”是学术的缩写，所以”ac.uk”就是本例中的二级域名，“hud”则是该域名的实际名称。如果要生成提取该特征的规则，首先我们应该忽略”www.”,然后删除掉国家代码和顶级域名的部分，如果还有剩下的话，我们就计算剩余的”.”的数量，如果点的数量大于两个，我们就将它归类为钓鱼网站，如果没有“.”存在，则归类为合法网站，剩下情况则为可疑网站。

特征8.使用https的网址

	通常情况下，人们会认为包含“https”的网址一定是合法网站，但这显然是不够的。有研究人员建议HTTPS分配的证书（包括证书颁发机构和证书年龄），经研究人员测试，通常情况下，最低的信任证书颁发年限为两年。如果使用https并且证书颁发机构是可信的并且证书年限大于一年，则为合法网站，如果使用https但证书颁发者不被信任，则为可疑网站，剩下的网站则为钓鱼网站。

特征9.域名注册期限

	由于通常情况下钓鱼网站存活期较短，所以研究人员认为值得信赖的网站一般都已经注册了好几年。在本文的数据集中，研究人员发现最长的钓鱼网站域名也仅仅只使用了一年。

特征10.图标的使用

	图标是和特定网页相关联的图像，很多图形浏览器和新闻阅读器都会在地址栏中显示网站表示的图标。如果图标是从地址栏中显示的域名以外的域名加载的，那么该网页被认为是钓鱼网站。

特征11.是否使用非标准端口

	这个功能在验证特定服务（例如HTTP）在特定服务器上是启动还是停止是很有用的。通常情况下，为了防止被入侵，最好只开放几个你所需要的端口。通常情况下防火墙，代理和网络地址转换将会阻止你访问大部分端口而仅仅开放你所选择的端口。如果所有端口都是开放的，那么钓鱼者可以运行他们想要运行的任何服务。

特征12.域名中包含”https”字符

	部分钓鱼者会将”https”加入到URL的域名部分用以欺骗用户。例如：“http://https-www-paypal-it-webapps-mpp-home.soft-hair.com/”

3.2.2基于网页异常部分提取特征

特征13.请求URL
	请求URL可以检测网页中包含的外部对象（例如图片视频和声音）是否是从另一个域中加载。通常情况下，网页地址和大部分嵌入在该网页中的对象都拥有相同的域。如果只有22%以内的对象是从另一个域加载的，那么判断为合法网页，如果有62%以上的对象是从另一个域加载的则判断为钓鱼网页。

特征14.网页中的锚链接
	锚链接是一种被“<a>”标签所包围的元素，他被认为是一次新的请求。所以如果锚链接中的网址和该网站有着不同的域名则视为正常，然而如果一个锚链接没有指向任何其他网页，如图九，若不正常锚链接的总数占总的锚链接数量的百分比超过60%，则被认为是钓鱼网站。
	
	图九，不正常的锚链接

特征15.在特定元素中的链接数量
	通过考虑网页源代码中的方方面面，我们发现，对于合法网站来说，使用<Meta>标签来提供相关HTML文档的元数据是十分常见的;而<Script>标签被用来创建客户端脚本;<Link>标签被用来检索其他网络资源。而通常情况下，这些标签都链接到了网页的相同域。但一般这些标签里所包含的链接数量都不会太多，如果链接数量百分比超过80%，则基本可认为该网站为钓鱼网站。

特征16.服务器处理表单的结果（SFH）
	由于正常情况下，服务器会对我们提交的信息采取行动，所以如果SFH中包含空字符串或者”about:blank”，那么该网站将会被认为是钓鱼网站，因为服务器根本就没有处理我们提交的信息。而正常网站服务器是不可能不处理的。

特征17.向邮箱提交信息
	因为WEB表单是允许用户将他们的信息提交给服务器，所以钓鱼者有可能会将用户的信息重定向他们的邮箱，通过使用服务器端脚本语言，例如PHP中的“mail()”函数。所以如果使用了”mail()”或者”mailto”来提交用户信息，则可能为钓鱼网站。

特征18.异常URL
	对于合法的网站而言，他们的URL中通常会包含identity。所以如果一个网站的URL中不包含主机名，则被认为是钓鱼网站。

3.2.3基于html和js代码提取特征
特征19.重定向次数
	区分钓鱼网站和合法网站的细微之处在于一个网站被重定向了多少次。根据调查人员研究，在他们的数据集中，合法的网站一般最多被重定向一次，而包含重定向的钓鱼网站一般至少被重定向了至少四次。

特征20.状态栏是否被定制
	钓鱼者可以使用JS在状态栏中向用户显示假URL，以达到欺骗用户的目的。如果我们想检查这一点，那么必须深入到网页源代码中去，特点需要检查网页的“onmouseover”事件，并且检查该事件是否使状态栏发生改变。

特征21.是否禁用右键
	部分钓鱼者为了防止用户查看网页源代码，通常会使用JS禁止右键单击函数，以防止用户查看网页源代码。如果需要检查这一点，我们也需要深入网页源代码，去检查”event.button == 2”事件并且检查右键单击事件是否被禁用。

特征22.是否使用弹出窗口
	通常情况下，合法网站不会让他的用户在弹出窗口上填写他们的个人信息，一般正常网站上的弹出窗口多被用于警告用户有关欺诈活动或者用于广告。所以我们可以根据网页是否弹出窗口并且弹出窗口上是否要求用户填写信息来判断该网页是否为钓鱼网站。

特征23.使用IFrame显示其他网页
	IFrame是一个HTML标记，一般用于在某个网页中显示其他网页。钓鱼者可以使用该标签，并让它的边框不可见，然后部分套用正规网站的界面，已达到自己欺骗用户的目的。

3.2.4基于域名提取特征

特征24.域名年龄
	研究人员通过从WHOIS数据库中提取数据研究发现，大多数的钓鱼网站的存活周期都十分短暂，他们发现合法域名的最低年龄为6个月。所以如果待检测域名的年龄大于6个月，则可以认为是合法网站。
	
特征25.DNS记录
	对于钓鱼网站而言，他们网站声称的身份是不会被WHOIS数据库识别，也无法在主机名中找到他们的记录。所以如果一个网站的DNS记录为空或者未找到，则认为该网站为钓鱼网站。

特征26.网络访问量
	研究人员发现可以通过访问者的数量和被访问的页面数量来衡量该网站的受欢迎程度。然而由于钓鱼网站的生存周期较短，所以通常情况下他们不会被Alexa数据库识别。研究人员发现通过审查他们的数据集，在最差的情况下，合法网站的受欢迎程度都在十万名之前。除此之外，如果该域名没有访问流量或者并没有被Alexa数据库识别，我们依然会认为它是钓鱼网站。

特征27.PageRank
	PageRank是一个从0到1的值，常被用于衡量该网页在互联网上的重要程度，PageRank的值越大，该网页越重要。在我们的数据集中，研究人员发现大约有95%的钓鱼网页没有PageRank，而剩余的钓鱼网页的PageRank值可能高达0.2。所以如果一个网页的PageRank小于0.2,我们就判定其为钓鱼网站。

特征28.是否存在于谷歌索引中
	由于一般情况下钓鱼网站只能在很短的时间内访问，所以很多钓鱼网站是无法在谷歌索引中找到的。所以我们可以根据某个网站是否在谷歌索引中来判断其是否为钓鱼网站。

特征29.指向该网页的外链接数量
	因为钓鱼网站的寿命较短，所以一般是没有外部链接指向它们的。因此指向网页的链接数量通常情况下可以表示他们的合法性级别。据研究人员调查发现，大约有98%的钓鱼网站并没有指向他们的外链接，而合法网站一般至少有2个指向它们的外部链接。

特征30.该网址域名是否在调查报告中出现
	互联网上的许多反钓鱼网站的团体（例如PhishTank)在每段时间内都会编写很多有关钓鱼网站的统计报告。所以我们采用今年来这些团体发布的报告中的数据，如果该网址的域名出现在十大常见钓鱼网站域名这样的报告中，则判定该网页为钓鱼网站。
	 

	
3.3数据预处理

3.4 分类器训练

3.5测试数据

3.6 本章小结
